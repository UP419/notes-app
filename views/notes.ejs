<%- include('partials/header'); -%>

<h2>Here are notes</h2>
<input type="text" name="note" required/>
<button id=""> Add Note</button>
<ul id="notes-list">
</ul>

<script>
  document.addEventListener('DOMContentLoaded', async () => {
    try {
      const res = await fetch('/getAllNotes', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        }
      });
      const data = await res.json();

      const notesList = document.getElementById('notes-list');
      data.forEach(note => {
        const listItem = document.createElement('li');
        listItem.textContent = note.note;
        notesList.appendChild(listItem);
      });
    } catch (err) {
      console.error('Error fetching notes:', err);
    }
    const addButton = document.querySelector('button');

    addButton.addEventListener('click', async () => {
      const noteInput = document.querySelector('input[name="note"]');
      const newNote = noteInput.value.trim();
      if (newNote) {
        try {
          const res = await fetch('/AddNote', {
            method: 'POST',
            body: JSON.stringify({ note: newNote }),
            headers: {
              'Content-Type': 'application/json'
            }
          });
          const data = await res.json();
          const notesList = document.getElementById('notes-list');
          const listItem = document.createElement('li');
          listItem.textContent = newNote; 
          notesList.appendChild(listItem);
          noteInput.value = '';
        } catch (err) {
          console.error('Error adding note:', err);
        }
      }
    });
  });
</script>